
.root {
  position: fixed;
  top: 0; right: 0;
  width: 420px;
  max-width: 92vw;
  height: 100%;
  background: hsl(var(--card));
  border-left: 1px solid hsl(var(--border));
  display: grid;
  grid-template-rows: auto auto 1fr auto;
  box-shadow: -14px 0 40px rgba(0,0,0,.15);
  z-index: 40;
}

.root :global(.ProseMirror) {
  outline: none;
  caret-color: currentColor;
}
.root :global(.ProseMirror ul),
.root :global(.ProseMirror ol) {
  padding-inline-start: 1.5rem;
  list-style: revert;
}

.root :global(.ProseMirror table) {
    border-collapse: collapse;
    width: 100%;
    margin: 1em 0;
    color: hsl(var(--foreground));
}

.root :global(.ProseMirror .resizing) {
  border: 2px solid hsl(var(--ring));
}

.root :global(.ProseMirror th),
.root :global(.ProseMirror td) {
  border: 1px solid hsl(var(--border));
  padding: 0.5em;
  min-width: 1em;
  vertical-align: top;
  box-sizing: border-box;
  position: relative;
  color: hsl(var(--foreground));
}

.root :global(.ProseMirror th) {
  font-weight: bold;
  text-align: left;
  background-color: hsl(var(--muted));
}
.root :global(.ProseMirror .selectedCell:after) {
    z-index: 2;
    position: absolute;
    content: "";
    left: 0; right: 0; top: 0; bottom: 0;
    background: hsla(var(--primary), 0.1);
    pointer-events: none;
}
.root :global(.ProseMirror .grip-column) {
    width: 8px;
    top: 0;
    right: -4px;
    position: absolute;
    background-color: hsl(var(--border));
    cursor: col-resize;
}
.root :global(.ProseMirror .grip-column:hover) {
    background-color: hsl(var(--ring));
}


.header {
  display: flex; align-items: center; justify-content: space-between;
  padding: 10px 12px;
  border-bottom: 1px solid hsl(var(--border));
}
.titleWrap { display: grid; gap: 2px; }
.title { margin: 0; font-size: 16px; font-weight: 700; color: hsl(var(--card-foreground)); }
.subtitle { margin: 0; font-size: 12px; color: hsl(var(--muted-foreground)); }
.close {
  font-size: 20px; line-height: 18px;
  height: 28px; width: 28px;
  display: grid; place-items: center;
  border: 1px solid hsl(var(--border));
  border-radius: 6px;
  background: hsl(var(--background)); color: hsl(var(--foreground)); cursor: pointer;
}

.tabs {
  display: flex;
  overflow-x: auto; 
  gap: 6px; 
  padding: 6px;
  border-bottom: 1px solid hsl(var(--border));
  scrollbar-width: none; /* Firefox */
}
.tabs::-webkit-scrollbar {
  display: none; /* Safari and Chrome */
}

.tab {
  height: 32px; padding: 0 10px; white-space: nowrap;
  background: hsl(var(--accent) / 0.1); 
  color: hsl(var(--accent));
  border: 1px solid hsl(var(--accent) / 0.2); 
  border-radius: 8px; 
  cursor: pointer;
  font-weight: 500;
}
.tab:hover {
    background: hsl(var(--accent) / 0.2);
}
.tabActive { 
    background: hsl(var(--primary));
    color: hsl(var(--primary-foreground));
    border-color: hsl(var(--primary)); 
}
.tabActive:hover {
    background: hsl(var(--primary) / 0.9);
}

.body { overflow: auto; padding: 16px; }

.footer {
  border-top: 1px solid hsl(var(--border));
  display: flex; align-items: center; justify-content: space-between;
  padding: 8px 12px; gap: 10px;
  background: hsl(var(--background));
}

.ok { color: hsl(var(--success)); font-size: 12px; }
.tip { color: hsl(var(--muted-foreground)); font-size: 12px; }

.problems { list-style: none; padding: 0; margin: 0; display: grid; gap: 2px; }
.problemItem { display: grid; grid-template-columns: 100px 1fr; gap: 8px; }
.problemField { color: hsl(var(--muted-foreground)); font-size: 12px; }
.problemMsg { color: hsl(var(--destructive)); font-size: 12px; }

/* Shared form styles */
.tabBody { display: grid; gap: 24px; }
.field { display: grid; gap: 6px; }
.fieldNarrow { display: grid; gap: 6px; min-width: 140px; }


.row { display: grid; grid-template-columns: 160px 1fr; gap: 8px; align-items: end; }
.rowHeader { display: flex; align-items: center; justify-content: space-between; }
.subhead { margin: 0; font-size: 14px; font-weight: 600; color: hsl(var(--foreground)); }

.list { display: grid; gap: 6px; padding: 0; margin: 0; list-style: none; }
.listItem { display: grid; grid-template-columns: 1fr auto; gap: 6px; align-items: center; }
.listItemTwo { display: grid; grid-template-columns: 1fr 1fr auto; gap: 6px; align-items: center; }


.err { color: hsl(var(--destructive)); font-size: 12px; }
.warn { color: hsl(var(--destructive)); font-size: 12px; }

.infoRow { display: flex; gap: 8px; align-items: center; }

.muted { color: hsl(var(--muted-foreground)); font-size: 12px; }
.details { border: 1px dashed hsl(var(--border)); border-radius: 8px; padding: 8px; }
.attachRow { padding-top: 4px; }


/* New styles for Rich Text Editor and Attachments */
.editorArea {
    background-color: hsl(var(--background));
    padding: 0;
}

.attachmentGrid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 0.75rem;
}

.attachmentCard {
    position: relative;
    aspect-ratio: 1 / 1;
    background-color: hsl(var(--muted));
    border-radius: 0.5rem;
    overflow: hidden;
    border: 1px solid hsl(var(--border));
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    transition: all 0.2s ease-in-out;
}
.attachmentCard:hover {
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    transform: translateY(-2px);
}
.attachmentCard:hover .attachmentCardHover {
    opacity: 1;
}

.attachmentImage {
    position: absolute;
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.attachmentIcon {
    flex-grow: 1;
    display: grid;
    place-items: center;
    color: hsl(var(--muted-foreground));
    padding: 1rem;
}

.attachmentLabel {
    font-size: 12px;
    padding: 6px 8px;
    width: 100%;
    text-align: left;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    background-color: hsla(var(--background), 0.8);
    border-top: 1px solid hsl(var(--border));
    backdrop-filter: blur(2px);
}

.attachmentOverlay {
    position: absolute;
    inset: 0;
    display: grid;
    place-items: center;
    font-size: 24px;
    font-weight: 700;
    color: hsl(var(--primary-foreground));
    background-color: hsla(var(--primary), 0.8);
    backdrop-filter: blur(4px);
}

.attachmentDelete {
    position: absolute;
    top: 6px;
    right: 6px;
    background: hsl(var(--card) / 0.8);
    border: 1px solid hsl(var(--border));
    color: hsl(var(--muted-foreground));
    border-radius: 999px;
    width: 24px;
    height: 24px;
    display: grid;
    place-items: center;
    cursor: pointer;
    transition: all 0.2s;
    z-index: 10;
    backdrop-filter: blur(2px);
    opacity: 0;
}
.attachmentCard:hover .attachmentDelete {
    opacity: 1;
}
.attachmentDelete:hover {
    background: hsl(var(--destructive));
    color: hsl(var(--destructive-foreground));
    transform: scale(1.1);
}

.attachmentCardHover {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.4);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.2s ease-in-out;
}

.editorFooter {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 12px;
    border-top: 1px solid hsl(var(--border));
}
.footerActions {
    display: flex;
    gap: 8px;
}


/* Mobile: bottom sheet */
@media (max-width: 768px) {
  .root {
    width: 100%;
    left: 0; right: 0;
    top: auto; bottom: 0; height: min(82vh, 720px);
    border-left: none; border-top: 1px solid hsl(var(--border));
    border-radius: 12px 12px 0 0;
  }
}
